
(function(a,b){if(typeof exports==="object"){module.exports=b()}else{if(typeof define==="function"&&define.amd){define("GMaps",[],b)}}a.GMaps=b()}(this,function(){
/*!
 * GMaps.js v0.4.15
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2014, Gustavo Leon
 * Released under the MIT License.
 */
;if(!(typeof window.google==="object"&&window.google.maps)){throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."}var h=function(n,o){var m;if(n===o){return n}for(m in o){n[m]=o[m]}return n};var d=function(o,n){var m;if(o===n){return o}for(m in n){if(o[m]!=undefined){o[m]=n[m]}}return o};var k=function(r,q){var n=Array.prototype.slice.call(arguments,2),p=[],m=r.length,o;if(Array.prototype.map&&r.map===Array.prototype.map){p=Array.prototype.map.call(r,function(s){callback_params=n;callback_params.splice(0,0,s);return q.apply(this,callback_params)})}else{for(o=0;o<m;o++){callback_params=n;callback_params.splice(0,0,r[o]);p.push(q.apply(this,callback_params))}}return p};var f=function(o){var n=[],m;for(m=0;m<o.length;m++){n=n.concat(o[m])}return n};var l=function(n,o){var p=n[0],m=n[1];if(o){p=n[1];m=n[0]}return new google.maps.LatLng(p,m)};var i=function(n,o){var m;for(m=0;m<n.length;m++){if(!(n[m] instanceof google.maps.LatLng)){if(n[m].length>0&&typeof(n[m][0])=="object"){n[m]=i(n[m],o)}else{n[m]=l(n[m],o)}}}return n};var a=function(o,n){var m,o=o.replace("#","");if("jQuery" in this&&n){m=$("#"+o,n)[0]}else{m=document.getElementById(o)}return m};var g=function(n){var o=0,m=0;if(n.offsetParent){do{o+=n.offsetLeft;m+=n.offsetTop}while(n=n.offsetParent)}return[o,m]};var j=(function(n){var o=document;var m=function(u){if(!this){return new m(u)}u.zoom=u.zoom||15;u.mapType=u.mapType||"roadmap";var J=this,L,w=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],A=["mousemove","mouseout","mouseover"],C=["el","lat","lng","mapType","width","height","markerClusterer","enableNewStyle"],M=u.el||u.div,y=u.markerClusterer,N=google.maps.MapTypeId[u.mapType.toUpperCase()],H=new google.maps.LatLng(u.lat,u.lng),Q=u.zoomControl||true,q=u.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},K=q.style||"DEFAULT",r=q.position||"TOP_LEFT",D=u.panControl||true,x=u.mapTypeControl||true,B=u.scaleControl||true,z=u.streetViewControl||true,v=v||true,I={},F={zoom:this.zoom,center:H,mapTypeId:N},p={panControl:D,zoomControl:Q,zoomControlOptions:{style:google.maps.ZoomControlStyle[K],position:google.maps.ControlPosition[r]},mapTypeControl:x,scaleControl:B,streetViewControl:z,overviewMapControl:v};if(typeof(u.el)==="string"||typeof(u.div)==="string"){this.el=a(M,u.context)}else{this.el=M}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}window.context_menu=window.context_menu||{};window.context_menu[J.el.id]={};this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=u.zoom;this.registered_events={};this.el.style.width=u.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=u.height||this.el.scrollHeight||this.el.offsetHeight;google.maps.visualRefresh=u.enableNewStyle;for(L=0;L<C.length;L++){delete u[C[L]]}if(u.disableDefaultUI!=true){F=h(F,p)}I=h(F,u);for(L=0;L<w.length;L++){delete I[w[L]]}for(L=0;L<A.length;L++){delete I[A[L]]}this.map=new google.maps.Map(this.el,I);if(y){this.markerClusterer=y.apply(this,[this.map])}var E=function(V,aa){var Z="",ae=window.context_menu[J.el.id][V];for(var W in ae){if(ae.hasOwnProperty(W)){var Y=ae[W];Z+='<li><a id="'+V+"_"+W+'" href="#">'+Y.title+"</a></li>"}}if(!a("gmaps_context_menu")){return}var ab=a("gmaps_context_menu");ab.innerHTML=Z;var R=ab.getElementsByTagName("a"),ad=R.length,W;for(W=0;W<ad;W++){var T=R[W];var U=function(af){af.preventDefault();ae[this.id.replace(V+"_","")].action.apply(J,[aa]);J.hideContextMenu()};google.maps.event.clearListeners(T,"click");google.maps.event.addDomListenerOnce(T,"click",U,false)}var X=g.apply(this,[J.el]),S=X[0]+aa.pixel.x-15,ac=X[1]+aa.pixel.y-15;ab.style.left=S+"px";ab.style.top=ac+"px";ab.style.display="block"};this.buildContextMenu=function(T,S){if(T==="marker"){S.pixel={};var R=new google.maps.OverlayView();R.setMap(J.map);R.draw=function(){var V=R.getProjection(),U=S.marker.getPosition();S.pixel=V.fromLatLngToContainerPixel(U);E(T,S)}}else{E(T,S)}};this.setContextMenu=function(R){window.context_menu[J.el.id][R.control]={};var T,S=o.createElement("ul");for(T in R.options){if(R.options.hasOwnProperty(T)){var U=R.options[T];window.context_menu[J.el.id][R.control][U.name]={title:U.title,action:U.action}}}S.id="gmaps_context_menu";S.style.display="none";S.style.position="absolute";S.style.minWidth="100px";S.style.background="white";S.style.listStyle="none";S.style.padding="8px";S.style.boxShadow="2px 2px 6px #ccc";o.body.appendChild(S);var V=a("gmaps_context_menu");google.maps.event.addDomListener(V,"mouseout",function(W){if(!W.relatedTarget||!this.contains(W.relatedTarget)){window.setTimeout(function(){V.style.display="none"},400)}},false)};this.hideContextMenu=function(){var R=a("gmaps_context_menu");if(R){R.style.display="none"}};var G=function(S,R){google.maps.event.addListener(S,R,function(T){if(T==undefined){T=this}u[R].apply(this,[T]);J.hideContextMenu()})};google.maps.event.addListener(this.map,"zoom_changed",this.hideContextMenu);for(var O=0;O<w.length;O++){var P=w[O];if(P in u){G(this.map,P)}}for(var O=0;O<A.length;O++){var P=A[O];if(P in u){G(this.map,P)}}google.maps.event.addListener(this.map,"rightclick",function(R){if(u.rightclick){u.rightclick.apply(this,[R])}if(window.context_menu[J.el.id]["map"]!=undefined){J.buildContextMenu("map",R)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var T=[],R=this.markers.length,S;for(S=0;S<R;S++){if(typeof(this.markers[S].visible)==="boolean"&&this.markers[S].visible){T.push(this.markers[S].getPosition())}}this.fitLatLngBounds(T)};this.fitLatLngBounds=function(U){var T=U.length;var S=new google.maps.LatLngBounds();for(var R=0;R<T;R++){S.extend(U[R])}this.map.fitBounds(S)};this.setCenter=function(S,R,T){this.map.panTo(new google.maps.LatLng(S,R));if(T){T()}};this.getElement=function(){return this.el};this.zoomIn=function(R){R=R||1;this.zoom=this.map.getZoom()+R;this.map.setZoom(this.zoom)};this.zoomOut=function(R){R=R||1;this.zoom=this.map.getZoom()-R;this.map.setZoom(this.zoom)};var t=[],s;for(s in this.map){if(typeof(this.map[s])=="function"&&!this[s]){t.push(s)}}for(L=0;L<t.length;L++){(function(R,T,S){R[S]=function(){return T[S].apply(T,arguments)}})(this,this.map,t[L])}};return m})(this);j.prototype.createControl=function(m){var p=document.createElement("div");p.style.cursor="pointer";if(m.disableDefaultStyles!==true){p.style.fontFamily="Roboto, Arial, sans-serif";p.style.fontSize="11px";p.style.boxShadow="rgba(0, 0, 0, 0.298039) 0px 1px 4px -1px"}for(var n in m.style){p.style[n]=m.style[n]}if(m.id){p.id=m.id}if(m.classes){p.className=m.classes}if(m.content){if(typeof m.content==="string"){p.innerHTML=m.content}else{if(m.content instanceof HTMLElement){p.appendChild(m.content)}}}if(m.position){p.position=google.maps.ControlPosition[m.position.toUpperCase()]}for(var o in m.events){(function(r,q){google.maps.event.addDomListener(r,q,function(){m.events[q].apply(this,[this])})})(p,o)}p.index=1;return p};j.prototype.addControl=function(m){var n=this.createControl(m);this.controls.push(n);this.map.controls[n.position].push(n);return n};j.prototype.removeControl=function(p){var m=null;for(var o=0;o<this.controls.length;o++){if(this.controls[o]==p){m=this.controls[o].position;this.controls.splice(o,1)}}if(m){for(o=0;o<this.map.controls.length;o++){var n=this.map.controls[p.position];if(n.getAt(o)==p){n.removeAt(o);break}}}return p};j.prototype.createMarker=function(x){if(x.lat==undefined&&x.lng==undefined&&x.position==undefined){throw"No latitude or longitude defined."}var w=this,n=x.details,r=x.fences,t=x.outside,q={position:new google.maps.LatLng(x.lat,x.lng),map:null},o=h(q,x);delete o.lat;delete o.lng;delete o.fences;delete o.outside;var s=new google.maps.Marker(o);s.fences=r;if(x.infoWindow){s.infoWindow=new google.maps.InfoWindow(x.infoWindow);var m=["closeclick","content_changed","domready","position_changed","zindex_changed"];for(var u=0;u<m.length;u++){(function(z,y){if(x.infoWindow[y]){google.maps.event.addListener(z,y,function(A){x.infoWindow[y].apply(this,[A])})}})(s.infoWindow,m[u])}}var v=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"];var p=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"];for(var u=0;u<v.length;u++){(function(z,y){if(x[y]){google.maps.event.addListener(z,y,function(){x[y].apply(this,[this])})}})(s,v[u])}for(var u=0;u<p.length;u++){(function(A,z,y){if(x[y]){google.maps.event.addListener(z,y,function(B){if(!B.pixel){B.pixel=A.getProjection().fromLatLngToPoint(B.latLng)}x[y].apply(this,[B])})}})(this.map,s,p[u])}google.maps.event.addListener(s,"click",function(){this.details=n;if(x.click){x.click.apply(this,[this])}if(s.infoWindow){w.hideInfoWindows();s.infoWindow.open(w.map,s)}});google.maps.event.addListener(s,"rightclick",function(y){y.marker=this;if(x.rightclick){x.rightclick.apply(this,[y])}if(window.context_menu[w.el.id]["marker"]!=undefined){w.buildContextMenu("marker",y)}});if(s.fences){google.maps.event.addListener(s,"dragend",function(){w.checkMarkerGeofence(s,function(y,z){t(y,z)})})}return s};j.prototype.addMarker=function(n){var m;if(n.hasOwnProperty("gm_accessors_")){m=n}else{if((n.hasOwnProperty("lat")&&n.hasOwnProperty("lng"))||n.position){m=this.createMarker(n)}else{throw"No latitude or longitude defined."}}m.setMap(this.map);if(this.markerClusterer){this.markerClusterer.addMarker(m)}this.markers.push(m);j.fire("marker_added",m,this);return m};j.prototype.addMarkers=function(o){for(var n=0,m;m=o[n];n++){this.addMarker(m)}return this.markers};j.prototype.hideInfoWindows=function(){for(var n=0,m;m=this.markers[n];n++){if(m.infoWindow){m.infoWindow.close()}}};j.prototype.removeMarker=function(m){for(var n=0;n<this.markers.length;n++){if(this.markers[n]===m){this.markers[n].setMap(null);this.markers.splice(n,1);if(this.markerClusterer){this.markerClusterer.removeMarker(m)}j.fire("marker_removed",m,this);break}}return m};j.prototype.removeMarkers=function(o){var m=[];if(typeof o=="undefined"){for(var n=0;n<this.markers.length;n++){this.markers[n].setMap(null)}this.markers=m}else{for(var n=0;n<o.length;n++){if(this.markers.indexOf(o[n])>-1){this.markers[n].setMap(null)}}for(var n=0;n<this.markers.length;n++){if(this.markers[n].getMap()!=null){m.push(this.markers[n])}}this.markers=m}};j.prototype.drawOverlay=function(n){var m=new google.maps.OverlayView(),o=true;m.setMap(this.map);if(n.auto_show!=null){o=n.auto_show}m.onAdd=function(){var s=document.createElement("div");s.style.borderStyle="none";s.style.borderWidth="0px";s.style.position="absolute";s.style.zIndex=100;s.innerHTML=n.content;m.el=s;if(!n.layer){n.layer="overlayLayer"}var r=this.getPanes(),p=r[n.layer],q=["contextmenu","DOMMouseScroll","dblclick","mousedown"];p.appendChild(s);for(var t=0;t<q.length;t++){(function(v,u){google.maps.event.addDomListener(v,u,function(w){if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all){w.cancelBubble=true;w.returnValue=false}else{w.stopPropagation()}})})(s,q[t])}if(n.click){r.overlayMouseTarget.appendChild(m.el);google.maps.event.addDomListener(m.el,"click",function(){n.click.apply(m,[m])})}google.maps.event.trigger(this,"ready")};m.draw=function(){var p=this.getProjection(),r=p.fromLatLngToDivPixel(new google.maps.LatLng(n.lat,n.lng));n.horizontalOffset=n.horizontalOffset||0;n.verticalOffset=n.verticalOffset||0;var s=m.el,t=s.children[0],q=t.clientHeight,u=t.clientWidth;switch(n.verticalAlign){case"top":s.style.top=(r.y-q+n.verticalOffset)+"px";break;default:case"middle":s.style.top=(r.y-(q/2)+n.verticalOffset)+"px";break;case"bottom":s.style.top=(r.y+n.verticalOffset)+"px";break}switch(n.horizontalAlign){case"left":s.style.left=(r.x-u+n.horizontalOffset)+"px";break;default:case"center":s.style.left=(r.x-(u/2)+n.horizontalOffset)+"px";break;case"right":s.style.left=(r.x+n.horizontalOffset)+"px";break}s.style.display=o?"block":"none";if(!o){n.show.apply(this,[s])}};m.onRemove=function(){var p=m.el;if(n.remove){n.remove.apply(this,[p])}else{m.el.parentNode.removeChild(m.el);m.el=null}};this.overlays.push(m);return m};j.prototype.removeOverlay=function(m){for(var n=0;n<this.overlays.length;n++){if(this.overlays[n]===m){this.overlays[n].setMap(null);this.overlays.splice(n,1);break}}};j.prototype.removeOverlays=function(){for(var m=0,n;n=this.overlays[m];m++){n.setMap(null)}this.overlays=[]};j.prototype.drawPolyline=function(u){var t=[],r=u.path;if(r.length){if(r[0][0]===undefined){t=r}else{for(var n=0,m;m=r[n];n++){t.push(new google.maps.LatLng(m[0],m[1]))}}}var o={map:this.map,path:t,strokeColor:u.strokeColor,strokeOpacity:u.strokeOpacity,strokeWeight:u.strokeWeight,geodesic:u.geodesic,clickable:true,editable:false,visible:true};if(u.hasOwnProperty("clickable")){o.clickable=u.clickable}if(u.hasOwnProperty("editable")){o.editable=u.editable}if(u.hasOwnProperty("icons")){o.icons=u.icons}if(u.hasOwnProperty("zIndex")){o.zIndex=u.zIndex}var q=new google.maps.Polyline(o);var s=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var p=0;p<s.length;p++){(function(w,v){if(u[v]){google.maps.event.addListener(w,v,function(x){u[v].apply(this,[x])})}})(q,s[p])}this.polylines.push(q);j.fire("polyline_added",q,this);return q};j.prototype.removePolyline=function(m){for(var n=0;n<this.polylines.length;n++){if(this.polylines[n]===m){this.polylines[n].setMap(null);this.polylines.splice(n,1);j.fire("polyline_removed",m,this);break}}};j.prototype.removePolylines=function(){for(var m=0,n;n=this.polylines[m];m++){n.setMap(null)}this.polylines=[]};j.prototype.drawCircle=function(m){m=h({map:this.map,center:new google.maps.LatLng(m.lat,m.lng)},m);delete m.lat;delete m.lng;var n=new google.maps.Circle(m),p=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var o=0;o<p.length;o++){(function(r,q){if(m[q]){google.maps.event.addListener(r,q,function(s){m[q].apply(this,[s])})}})(n,p[o])}this.polygons.push(n);return n};j.prototype.drawRectangle=function(m){m=h({map:this.map},m);var p=new google.maps.LatLngBounds(new google.maps.LatLng(m.bounds[0][0],m.bounds[0][1]),new google.maps.LatLng(m.bounds[1][0],m.bounds[1][1]));m.bounds=p;var n=new google.maps.Rectangle(m),q=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var o=0;o<q.length;o++){(function(s,r){if(m[r]){google.maps.event.addListener(s,r,function(t){m[r].apply(this,[t])})}})(n,q[o])}this.polygons.push(n);return n};j.prototype.drawPolygon=function(m){var p=false;if(m.hasOwnProperty("useGeoJSON")){p=m.useGeoJSON}delete m.useGeoJSON;m=h({map:this.map},m);if(p==false){m.paths=[m.paths.slice(0)]}if(m.paths.length>0){if(m.paths[0].length>0){m.paths=f(k(m.paths,i,p))}}var n=new google.maps.Polygon(m),q=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var o=0;o<q.length;o++){(function(s,r){if(m[r]){google.maps.event.addListener(s,r,function(t){m[r].apply(this,[t])})}})(n,q[o])}this.polygons.push(n);j.fire("polygon_added",n,this);return n};j.prototype.removePolygon=function(n){for(var m=0;m<this.polygons.length;m++){if(this.polygons[m]===n){this.polygons[m].setMap(null);this.polygons.splice(m,1);j.fire("polygon_removed",n,this);break}}};j.prototype.removePolygons=function(){for(var m=0,n;n=this.polygons[m];m++){n.setMap(null)}this.polygons=[]};j.prototype.getFromFusionTables=function(n){var p=n.events;delete n.events;var m=n,o=new google.maps.FusionTablesLayer(m);for(var q in p){(function(s,r){google.maps.event.addListener(s,r,function(t){p[r].apply(this,[t])})})(o,q)}this.layers.push(o);return o};j.prototype.loadFromFusionTables=function(m){var n=this.getFromFusionTables(m);n.setMap(this.map);return n};j.prototype.getFromKML=function(n){var m=n.url,p=n.events;delete n.url;delete n.events;var r=n,o=new google.maps.KmlLayer(m,r);for(var q in p){(function(t,s){google.maps.event.addListener(t,s,function(u){p[s].apply(this,[u])})})(o,q)}this.layers.push(o);return o};j.prototype.loadFromKML=function(m){var n=this.getFromKML(m);n.setMap(this.map);return n};j.prototype.addLayer=function(o,n){n=n||{};var p;switch(o){case"weather":this.singleLayers.weather=p=new google.maps.weather.WeatherLayer();break;case"clouds":this.singleLayers.clouds=p=new google.maps.weather.CloudLayer();break;case"traffic":this.singleLayers.traffic=p=new google.maps.TrafficLayer();break;case"transit":this.singleLayers.transit=p=new google.maps.TransitLayer();break;case"bicycling":this.singleLayers.bicycling=p=new google.maps.BicyclingLayer();break;case"panoramio":this.singleLayers.panoramio=p=new google.maps.panoramio.PanoramioLayer();p.setTag(n.filter);delete n.filter;if(n.click){google.maps.event.addListener(p,"click",function(r){n.click(r);delete n.click})}break;case"places":this.singleLayers.places=p=new google.maps.places.PlacesService(this.map);if(n.search||n.nearbySearch||n.radarSearch){var m={bounds:n.bounds||null,keyword:n.keyword||null,location:n.location||null,name:n.name||null,radius:n.radius||null,rankBy:n.rankBy||null,types:n.types||null};if(n.radarSearch){p.radarSearch(m,n.radarSearch)}if(n.search){p.search(m,n.search)}if(n.nearbySearch){p.nearbySearch(m,n.nearbySearch)}}if(n.textSearch){var q={bounds:n.bounds||null,location:n.location||null,query:n.query||null,radius:n.radius||null};p.textSearch(q,n.textSearch)}break}if(p!==undefined){if(typeof p.setOptions=="function"){p.setOptions(n)}if(typeof p.setMap=="function"){p.setMap(this.map)}return p}};j.prototype.removeLayer=function(n){if(typeof(n)=="string"&&this.singleLayers[n]!==undefined){this.singleLayers[n].setMap(null);delete this.singleLayers[n]}else{for(var m=0;m<this.layers.length;m++){if(this.layers[m]===n){this.layers[m].setMap(null);this.layers.splice(m,1);break}}}};var b,c;j.prototype.getRoutes=function(q){switch(q.travelMode){case"bicycling":b=google.maps.TravelMode.BICYCLING;break;case"transit":b=google.maps.TravelMode.TRANSIT;break;case"driving":b=google.maps.TravelMode.DRIVING;break;default:b=google.maps.TravelMode.WALKING;break}if(q.unitSystem==="imperial"){c=google.maps.UnitSystem.IMPERIAL}else{c=google.maps.UnitSystem.METRIC}var p={avoidHighways:false,avoidTolls:false,optimizeWaypoints:false,waypoints:[]},o=h(p,q);o.origin=/string/.test(typeof q.origin)?q.origin:new google.maps.LatLng(q.origin[0],q.origin[1]);o.destination=/string/.test(typeof q.destination)?q.destination:new google.maps.LatLng(q.destination[0],q.destination[1]);o.travelMode=b;o.unitSystem=c;delete o.callback;delete o.error;var n=this,m=new google.maps.DirectionsService();m.route(o,function(s,t){if(t===google.maps.DirectionsStatus.OK){for(var u in s.routes){if(s.routes.hasOwnProperty(u)){n.routes.push(s.routes[u])}}if(q.callback){q.callback(n.routes)}}else{if(q.error){q.error(s,t)}}})};j.prototype.removeRoutes=function(){this.routes=[]};j.prototype.getElevations=function(n){n=h({locations:[],path:false,samples:256},n);if(n.locations.length>0){if(n.locations[0].length>0){n.locations=f(k([n.locations],i,false))}}var p=n.callback;delete n.callback;var m=new google.maps.ElevationService();if(!n.path){delete n.path;delete n.samples;m.getElevationForLocations(n,function(q,r){if(p&&typeof(p)==="function"){p(q,r)}})}else{var o={path:n.locations,samples:n.samples};m.getElevationAlongPath(o,function(q,r){if(p&&typeof(p)==="function"){p(q,r)}})}};j.prototype.cleanRoute=j.prototype.removePolylines;j.prototype.drawRoute=function(n){var m=this;this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,unitSystem:n.unitSystem,error:n.error,callback:function(o){if(o.length>0){m.drawPolyline({path:o[o.length-1].overview_path,strokeColor:n.strokeColor,strokeOpacity:n.strokeOpacity,strokeWeight:n.strokeWeight});if(n.callback){n.callback(o[o.length-1])}}}})};j.prototype.travelRoute=function(n){if(n.origin&&n.destination){this.getRoutes({origin:n.origin,destination:n.destination,travelMode:n.travelMode,waypoints:n.waypoints,unitSystem:n.unitSystem,error:n.error,callback:function(u){if(u.length>0&&n.start){n.start(u[u.length-1])}if(u.length>0&&n.step){var r=u[u.length-1];if(r.legs.length>0){var q=r.legs[0].steps;for(var s=0,t;t=q[s];s++){t.step_number=s;n.step(t,(r.legs[0].steps.length-1))}}}if(u.length>0&&n.end){n.end(u[u.length-1])}}})}else{if(n.route){if(n.route.legs.length>0){var m=n.route.legs[0].steps;for(var o=0,p;p=m[o];o++){p.step_number=o;n.step(p)}}}}};j.prototype.drawSteppedRoute=function(o){var n=this;if(o.origin&&o.destination){this.getRoutes({origin:o.origin,destination:o.destination,travelMode:o.travelMode,waypoints:o.waypoints,error:o.error,callback:function(v){if(v.length>0&&o.start){o.start(v[v.length-1])}if(v.length>0&&o.step){var s=v[v.length-1];if(s.legs.length>0){var r=s.legs[0].steps;for(var t=0,u;u=r[t];t++){u.step_number=t;n.drawPolyline({path:u.path,strokeColor:o.strokeColor,strokeOpacity:o.strokeOpacity,strokeWeight:o.strokeWeight});o.step(u,(s.legs[0].steps.length-1))}}}if(v.length>0&&o.end){o.end(v[v.length-1])}}})}else{if(o.route){if(o.route.legs.length>0){var m=o.route.legs[0].steps;for(var p=0,q;q=m[p];p++){q.step_number=p;n.drawPolyline({path:q.path,strokeColor:o.strokeColor,strokeOpacity:o.strokeOpacity,strokeWeight:o.strokeWeight});o.step(q)}}}}};j.Route=function(m){this.origin=m.origin;this.destination=m.destination;this.waypoints=m.waypoints;this.map=m.map;this.route=m.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray(),strokeColor:m.strokeColor,strokeOpacity:m.strokeOpacity,strokeWeight:m.strokeWeight}).getPath()};j.Route.prototype.getRoute=function(n){var m=this;this.map.getRoutes({origin:this.origin,destination:this.destination,travelMode:n.travelMode,waypoints:this.waypoints||[],error:n.error,callback:function(){m.route=e[0];if(n.callback){n.callback.call(m)}}})};j.Route.prototype.back=function(){if(this.step_count>0){this.step_count--;var n=this.route.legs[0].steps[this.step_count].path;for(var m in n){if(n.hasOwnProperty(m)){this.polyline.pop()}}}};j.Route.prototype.forward=function(){if(this.step_count<this.steps_length){var n=this.route.legs[0].steps[this.step_count].path;for(var m in n){if(n.hasOwnProperty(m)){this.polyline.push(n[m])}}this.step_count++}};j.prototype.checkGeofence=function(n,m,o){return o.containsLatLng(new google.maps.LatLng(n,m))};j.prototype.checkMarkerGeofence=function(m,o){if(m.fences){for(var n=0,p;p=m.fences[n];n++){var q=m.getPosition();if(!this.checkGeofence(q.lat(),q.lng(),p)){o(m,p)}}}};j.prototype.toImage=function(n){var n=n||{},p={};p.size=n.size||[this.el.clientWidth,this.el.clientHeight];p.lat=this.getCenter().lat();p.lng=this.getCenter().lng();if(this.markers.length>0){p.markers=[];for(var o=0;o<this.markers.length;o++){p.markers.push({lat:this.markers[o].getPosition().lat(),lng:this.markers[o].getPosition().lng()})}}if(this.polylines.length>0){var m=this.polylines[0];p.polyline={};p.polyline["path"]=google.maps.geometry.encoding.encodePath(m.getPath());p.polyline["strokeColor"]=m.strokeColor;p.polyline["strokeOpacity"]=m.strokeOpacity;p.polyline["strokeWeight"]=m.strokeWeight}return j.staticMapURL(p)};j.staticMapURL=function(n){var t=[],L,o="http://maps.googleapis.com/maps/api/staticmap";if(n.url){o=n.url;delete n.url}o+="?";var I=n.markers;delete n.markers;if(!I&&n.marker){I=[n.marker];delete n.marker}var w=n.styles;delete n.styles;var B=n.polyline;delete n.polyline;if(n.center){t.push("center="+n.center);delete n.center}else{if(n.address){t.push("center="+n.address);delete n.address}else{if(n.lat){t.push(["center=",n.lat,",",n.lng].join(""));delete n.lat;delete n.lng}else{if(n.visible){var m=encodeURI(n.visible.join("|"));t.push("visible="+m)}}}}var z=n.size;if(z){if(z.join){z=z.join("x")}delete n.size}else{z="630x300"}t.push("size="+z);if(!n.zoom&&n.zoom!==false){n.zoom=15}var J=n.hasOwnProperty("sensor")?!!n.sensor:true;delete n.sensor;t.push("sensor="+J);for(var u in n){if(n.hasOwnProperty(u)){t.push(u+"="+n[u])}}if(I){var v,x;for(var F=0;L=I[F];F++){v=[];if(L.size&&L.size!=="normal"){v.push("size:"+L.size);delete L.size}else{if(L.icon){v.push("icon:"+encodeURI(L.icon));delete L.icon}}if(L.color){v.push("color:"+L.color.replace("#","0x"));delete L.color}if(L.label){v.push("label:"+L.label[0].toUpperCase());delete L.label}x=(L.address?L.address:L.lat+","+L.lng);delete L.address;delete L.lat;delete L.lng;for(var u in L){if(L.hasOwnProperty(u)){v.push(u+":"+L[u])}}if(v.length||F===0){v.push(x);v=v.join("|");t.push("markers="+encodeURI(v))}else{v=t.pop()+encodeURI("|"+x);t.push(v)}}}if(w){for(var F=0;F<w.length;F++){var y=[];if(w[F].featureType){y.push("feature:"+w[F].featureType.toLowerCase())}if(w[F].elementType){y.push("element:"+w[F].elementType.toLowerCase())}for(var E=0;E<w[F].stylers.length;E++){for(var C in w[F].stylers[E]){var G=w[F].stylers[E][C];if(C=="hue"||C=="color"){G="0x"+G.substring(1)}y.push(C+":"+G)}}var s=y.join("|");if(s!=""){t.push("style="+s)}}}function H(p,M){if(p[0]==="#"){p=p.replace("#","0x");if(M){M=parseFloat(M);M=Math.min(1,Math.max(M,0));if(M===0){return"0x00000000"}M=(M*255).toString(16);if(M.length===1){M+=M}p=p.slice(0,8)+M}}return p}if(B){L=B;B=[];if(L.strokeWeight){B.push("weight:"+parseInt(L.strokeWeight,10))}if(L.strokeColor){var D=H(L.strokeColor,L.strokeOpacity);B.push("color:"+D)}if(L.fillColor){var K=H(L.fillColor,L.fillOpacity);B.push("fillcolor:"+K)}var A=L.path;if(A.join){for(var E=0,r;r=A[E];E++){B.push(r.join(","))}}else{B.push("enc:"+A)}B=B.join("|");t.push("path="+encodeURI(B))}var q=window.devicePixelRatio||1;t.push("scale="+q);t=t.join("&");return o+t};j.prototype.addMapType=function(m,n){if(n.hasOwnProperty("getTileUrl")&&typeof(n.getTileUrl)=="function"){n.tileSize=n.tileSize||new google.maps.Size(256,256);var o=new google.maps.ImageMapType(n);this.map.mapTypes.set(m,o)}else{throw"'getTileUrl' function required."}};j.prototype.addOverlayMapType=function(m){if(m.hasOwnProperty("getTile")&&typeof(m.getTile)=="function"){var n=m.index;delete m.index;this.map.overlayMapTypes.insertAt(n,m)}else{throw"'getTile' function required."}};j.prototype.removeOverlayMapType=function(m){this.map.overlayMapTypes.removeAt(m)};j.prototype.addStyle=function(n){var m=new google.maps.StyledMapType(n.styles,{name:n.styledMapName});this.map.mapTypes.set(n.mapTypeId,m)};j.prototype.setStyle=function(m){this.map.setMapTypeId(m)};j.prototype.createPanorama=function(m){if(!m.hasOwnProperty("lat")||!m.hasOwnProperty("lng")){m.lat=this.getCenter().lat();m.lng=this.getCenter().lng()}this.panorama=j.createPanorama(m);this.map.setStreetView(this.panorama);return this.panorama};j.createPanorama=function(n){var q=a(n.el,n.context);n.position=new google.maps.LatLng(n.lat,n.lng);delete n.el;delete n.context;delete n.lat;delete n.lng;var r=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],m=h({visible:true},n);for(var p=0;p<r.length;p++){delete m[r[p]]}var o=new google.maps.StreetViewPanorama(q,m);for(var p=0;p<r.length;p++){(function(t,s){if(n[s]){google.maps.event.addListener(t,s,function(){n[s].apply(this)})}})(o,r[p])}return o};j.prototype.on=function(n,m){return j.on(n,this,m)};j.prototype.off=function(m){j.off(m,this)};j.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"];j.on=function(p,m,o){if(j.custom_events.indexOf(p)==-1){if(m instanceof j){m=m.map}return google.maps.event.addListener(m,p,o)}else{var n={handler:o,eventName:p};m.registered_events[p]=m.registered_events[p]||[];m.registered_events[p].push(n);return n}};j.off=function(n,m){if(j.custom_events.indexOf(n)==-1){if(m instanceof j){m=m.map}google.maps.event.clearListeners(m,n)}else{m.registered_events[n]=[]}};j.fire=function(q,m,p){if(j.custom_events.indexOf(q)==-1){google.maps.event.trigger(m,q,Array.prototype.slice.apply(arguments).slice(2))}else{if(q in p.registered_events){var o=p.registered_events[q];for(var n=0;n<o.length;n++){(function(t,s,r){t.apply(s,[r])})(o[n]["handler"],p,m)}}}};j.geolocate=function(m){var n=m.always||m.complete;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(o){m.success(o);if(n){n()}},function(o){m.error(o);if(n){n()}},m.options)}else{m.not_supported();if(n){n()}}};j.geocode=function(m){this.geocoder=new google.maps.Geocoder();var n=m.callback;if(m.hasOwnProperty("lat")&&m.hasOwnProperty("lng")){m.latLng=new google.maps.LatLng(m.lat,m.lng)}delete m.lat;delete m.lng;delete m.callback;this.geocoder.geocode(m,function(p,o){n(p,o)})};if(!google.maps.Polygon.prototype.getBounds){google.maps.Polygon.prototype.getBounds=function(o){var n=new google.maps.LatLngBounds();var s=this.getPaths();var r;for(var q=0;q<s.getLength();q++){r=s.getAt(q);for(var m=0;m<r.getLength();m++){n.extend(r.getAt(m))}}return n}}if(!google.maps.Polygon.prototype.containsLatLng){google.maps.Polygon.prototype.containsLatLng=function(r){var m=this.getBounds();if(m!==null&&!m.contains(r)){return false}var o=false;var n=this.getPaths().getLength();for(var q=0;q<n;q++){var x=this.getPaths().getAt(q);var u=x.getLength();var s=u-1;for(var t=0;t<u;t++){var w=x.getAt(t);var v=x.getAt(s);if(w.lng()<r.lng()&&v.lng()>=r.lng()||v.lng()<r.lng()&&w.lng()>=r.lng()){if(w.lat()+(r.lng()-w.lng())/(v.lng()-w.lng())*(v.lat()-w.lat())<r.lat()){o=!o}}s=t}}return o}}if(!google.maps.Circle.prototype.containsLatLng){google.maps.Circle.prototype.containsLatLng=function(m){if(google.maps.geometry){return google.maps.geometry.spherical.computeDistanceBetween(this.getCenter(),m)<=this.getRadius()}else{return true}}}google.maps.LatLngBounds.prototype.containsLatLng=function(m){return this.contains(m)};google.maps.Marker.prototype.setFences=function(m){this.fences=m};google.maps.Marker.prototype.addFence=function(m){this.fences.push(m)};google.maps.Marker.prototype.getId=function(){return this["__gm_id"]};if(!Array.prototype.indexOf){Array.prototype.indexOf=function(p){if(this==null){throw new TypeError()}var q=Object(this);var m=q.length>>>0;if(m===0){return -1}var r=0;if(arguments.length>1){r=Number(arguments[1]);if(r!=r){r=0}else{if(r!=0&&r!=Infinity&&r!=-Infinity){r=(r>0||-1)*Math.floor(Math.abs(r))}}}if(r>=m){return -1}var o=r>=0?r:Math.max(m-Math.abs(r),0);for(;o<m;o++){if(o in q&&q[o]===p){return o}}return -1}}return j}));

/**
* Maplace.js 0.1.33
*
* Copyright (c) 2013 Daniele Moraschi
* Licensed under the MIT license
* For all details and documentation:
* http://maplacejs.com
*/
(function(g,t,f,m){var q,n,p;q={activateCurrent:function(e){this.html_element.find("select").val(e)},getHtml:function(){var e=this,a="",b;if(1<this.ln){a+='<select class="dropdown controls '+this.o.controls_cssclass+'">';this.ShowOnMenu(this.view_all_key)&&(a+='<option value="'+this.view_all_key+'">'+this.o.view_all_text+"</option>");for(b=0;b<this.ln;b+=1)this.ShowOnMenu(b)&&(a+='<option value="'+(b+1)+'">'+(this.o.locations[b].title||"#"+(b+1))+"</option>");a=g(a+"</select>").bind("change",function(){e.ViewOnMap(this.value)})}(b=
this.o.controls_title)&&(b=g('<div class="controls_title"></div>').css(this.o.controls_applycss?{fontWeight:"bold",fontSize:this.o.controls_on_map?"12px":"inherit",padding:"3px 10px 5px 0"}:{}).append(this.o.controls_title));return this.html_element=g('<div class="wrap_controls"></div>').append(b).append(a)}};n={html_a:function(e,a,b){var c=this;a=a||e+1;b=b||this.o.locations[e].title;e=g('<a data-load="'+a+'" id="ullist_a_'+a+'" href="#'+a+'" title="'+b+'"><span>'+(b||"#"+(e+1))+"</span></a>");e.css(this.o.controls_applycss?
{color:"#666",display:"block",padding:"5px",fontSize:this.o.controls_on_map?"12px":"inherit",textDecoration:"none"}:{});e.on("click",function(a){a.preventDefault();a=g(this).attr("data-load");c.ViewOnMap(a)});return e},activateCurrent:function(e){this.html_element.find("li").removeClass("active");this.html_element.find("#ullist_a_"+e).parent().addClass("active")},getHtml:function(){var e=g("<ul class='ullist controls "+this.o.controls_cssclass+"'></ul>").css(this.o.controls_applycss?{margin:0,padding:0,
listStyleType:"none"}:{}),a;this.ShowOnMenu(this.view_all_key)&&e.append(g("<li></li>").append(n.html_a.call(this,!1,this.view_all_key,this.o.view_all_text)));for(a=0;a<this.ln;a++)this.ShowOnMenu(a)&&e.append(g("<li></li>").append(n.html_a.call(this,a)));(a=this.o.controls_title)&&(a=g('<div class="controls_title"></div>').css(this.o.controls_applycss?{fontWeight:"bold",padding:"3px 10px 5px 0",fontSize:this.o.controls_on_map?"12px":"inherit"}:{}).append(this.o.controls_title));return this.html_element=
g('<div class="wrap_controls"></div>').append(a).append(e)}};p=function(){function e(a){this.VERSION="0.1.33";this.loaded=!1;this.markers=[];this.circles=[];this.oMap=!1;this.view_all_key="all";this.infowindow=null;this.ln=this.maxZIndex=0;this.oMap=!1;this.directionsDisplay=this.directionsService=this.Fusion=this.Polygon=this.Polyline=this.current_index=this.current_control=this.controls_wrapper=this.canvas_map=this.map_div=this.oBounds=null;this.o={debug:!1,map_div:"#gmap",controls_div:"#controls",
generate_controls:!0,controls_type:"dropdown",controls_cssclass:"",controls_title:"",controls_on_map:!0,controls_applycss:!0,controls_position:f.maps.ControlPosition.RIGHT_TOP,type:"marker",view_all:!0,view_all_text:"View All",pan_on_click:!0,start:0,locations:[],shared:{},map_options:{mapTypeId:f.maps.MapTypeId.ROADMAP},stroke_options:{strokeColor:"#0000FF",strokeOpacity:.8,strokeWeight:2,fillColor:"#0000FF",fillOpacity:.4},directions_options:{travelMode:f.maps.TravelMode.DRIVING,unitSystem:f.maps.UnitSystem.METRIC,
optimizeWaypoints:!1,provideRouteAlternatives:!1,avoidHighways:!1,avoidTolls:!1},circle_options:{radius:100,visible:!0},styles:{},fusion_options:{},directions_panel:null,draggable:!1,editable:!1,show_infowindows:!0,show_markers:!0,infowindow_type:"bubble",listeners:{},beforeViewAll:function(){},afterViewAll:function(){},beforeShow:function(a,c,d){},afterShow:function(a,c,d){},afterCreateMarker:function(a,c,d){},beforeCloseInfowindow:function(a,c){},afterCloseInfowindow:function(a,c){},beforeOpenInfowindow:function(a,
c,d){},afterOpenInfowindow:function(a,c,d){},afterRoute:function(a,c,d){},onPolylineClick:function(a){},onPolygonClick:function(a){},circleRadiusChanged:function(a,c,d){},circleCenterChanged:function(a,c,d){},drag:function(a,c,d){},dragEnd:function(a,c,d){},dragStart:function(a,c,d){}};this.AddControl("dropdown",q);this.AddControl("list",n);a&&"directions"===a.type&&(!a.show_markers&&(a.show_markers=!1),!a.show_infowindows&&(a.show_infowindows=!1));g.extend(!0,this.o,a)}e.prototype.controls={};e.prototype.create_objMap=
function(){var a=0,b;for(b in this.o.styles)this.o.styles.hasOwnProperty(b)&&(0===a&&(this.o.map_options.mapTypeControlOptions={mapTypeIds:[f.maps.MapTypeId.ROADMAP]}),a++,this.o.map_options.mapTypeControlOptions.mapTypeIds.push("map_style_"+a));if(this.loaded)this.oMap.setOptions(this.o.map_options);else try{this.map_div.css({position:"relative",overflow:"hidden"}),this.canvas_map=g("<div>").addClass("canvas_map").css({width:"100%",height:"100%"}).appendTo(this.map_div),this.oMap=new f.maps.Map(this.canvas_map.get(0),
this.o.map_options)}catch(c){this.debug("create_objMap::"+this.map_div.selector,c.toString())}a=0;for(b in this.o.styles)this.o.styles.hasOwnProperty(b)&&(a++,this.oMap.mapTypes.set("map_style_"+a,new f.maps.StyledMapType(this.o.styles[b],{name:b})),this.oMap.setMapTypeId("map_style_"+a))};e.prototype.add_markers_to_objMap=function(){var a,b;a=this.o.type||"marker";switch(a){case "marker":for(a=0;a<this.ln;a++)b=this.create_objPoint(a),this.create.marker.call(this,a,b);break;default:this.create[a].apply(this)}};
e.prototype.create_objPoint=function(a){a=g.extend({},this.o.locations[a]);var b=a.visible===m?m:a.visible;!a.type&&(a.type=this.o.type);a.map=this.oMap;a.position=new f.maps.LatLng(a.lat,a.lon);a.zIndex=a.zIndex===m?1E4:a.zIndex+100;a.visible=b===m?this.o.show_markers:b;this.o.maxZIndex=a.zIndex>this.maxZIndex?a.zIndex:this.maxZIndex;a.image&&(a.icon=new f.maps.MarkerImage(a.image,new f.maps.Size(a.image_w||32,a.image_h||32),new f.maps.Point(0,0),new f.maps.Point((a.image_w||32)/2,(a.image_h||32)/
2)));return a};e.prototype.create_objCircle=function(a){var b,c,d;d=g.extend({},a);b=g.extend({},this.o.stroke_options);c=g.extend({},this.o.circle_options);g.extend(b,a.stroke_options||{});g.extend(d,b);g.extend(c,a.circle_options||{});g.extend(d,c);d.center=a.position;d.draggable=!1;d.zIndex=0<a.zIndex?a.zIndex-10:1;return d};e.prototype.add_markerEv=function(a,b,c){var d=this;f.maps.event.addListener(c,"click",function(e){d.o.beforeShow(a,b,c);d.o.show_infowindows&&!1!==b.show_infowindow&&d.open_infowindow(a,
c,e);d.o.pan_on_click&&!1!==b.pan_on_click&&(d.oMap.panTo(b.position),b.zoom&&d.oMap.setZoom(b.zoom));d.current_control&&d.o.generate_controls&&d.current_control.activateCurrent&&d.current_control.activateCurrent.call(d,a+1);d.current_index=a;d.o.afterShow(a,b,c)});b.draggable&&this.add_dragEv(a,b,c)};e.prototype.add_circleEv=function(a,b,c){var d=this;f.maps.event.addListener(c,"click",function(){d.ViewOnMap(a+1)});f.maps.event.addListener(c,"center_changed",function(){d.o.circleCenterChanged(a,
b,c)});f.maps.event.addListener(c,"radius_changed",function(){d.o.circleRadiusChanged(a,b,c)});b.draggable&&this.add_dragEv(a,b,c)};e.prototype.add_dragEv=function(a,b,c){var d=this;f.maps.event.addListener(c,"drag",function(e){var g;if(c.getPosition)e=c.getPosition();else if(c.getCenter)e=c.getCenter();else return;d.circles[a]&&d.circles[a].setCenter(e);d.Polyline?g="Polyline":d.Polygon&&(g="Polygon");if(g){for(var k=d[g].getPath().getArray(),h=[],l=0;l<k.length;++l)h[l]=a===l?new f.maps.LatLng(e.lat(),
e.lng()):new f.maps.LatLng(k[l].lat(),k[l].lng());d[g].setPath(new f.maps.MVCArray(h));d.add_polyEv(g)}d.o.drag(a,b,c)});f.maps.event.addListener(c,"dragend",function(){d.o.dragEnd(a,b,c)});f.maps.event.addListener(c,"dragstart",function(){d.o.dragStart(a,b,c)});f.maps.event.addListener(c,"center_changed",function(){d.markers[a]&&c.getCenter&&d.markers[a].setPosition(c.getCenter());d.o.drag(a,b,c)})};e.prototype.add_polyEv=function(a){var b=this;f.maps.event.addListener(this[a].getPath(),"set_at",
function(c,d){var e=b[a].getPath().getAt(c),e=new f.maps.LatLng(e.lat(),e.lng());b.markers[c]&&b.markers[c].setPosition(e);b.circles[c]&&b.circles[c].setCenter(e);b.o["on"+a+"Changed"](c,d,b[a].getPath().getArray())})};e.prototype.create={marker:function(a,b,c){var d;"circle"!=b.type||c||(d=this.create_objCircle(b),b.visible||(d.draggable=b.draggable),c=new f.maps.Circle(d),this.add_circleEv(a,d,c),this.circles[a]=c);b.type="marker";c=new f.maps.Marker(b);this.add_markerEv(a,b,c);this.oBounds.extend(b.position);
this.markers[a]=c;this.o.afterCreateMarker(a,b,c);return c},circle:function(){var a,b,c,d;for(a=0;a<this.ln;a++)b=this.create_objPoint(a),"circle"==b.type&&(c=this.create_objCircle(b),b.visible||(c.draggable=b.draggable),d=new f.maps.Circle(c),this.add_circleEv(a,c,d),this.circles[a]=d),b.type="marker",this.create.marker.call(this,a,b,d)},polyline:function(){var a,b,c=g.extend({},this.o.stroke_options);c.path=[];c.draggable=this.o.draggable;c.editable=this.o.editable;c.map=this.oMap;c.zIndex=this.o.maxZIndex+
100;for(a=0;a<this.ln;a++)b=this.create_objPoint(a),this.create.marker.call(this,a,b),c.path.push(b.position);this.Polyline?this.Polyline.setOptions(c):this.Polyline=new f.maps.Polyline(c);this.add_polyEv("Polyline")},polygon:function(){var a=this,b,c,d=g.extend({},this.o.stroke_options);d.path=[];d.draggable=this.o.draggable;d.editable=this.o.editable;d.map=this.oMap;d.zIndex=this.o.maxZIndex+100;for(b=0;b<this.ln;b++)c=this.create_objPoint(b),this.create.marker.call(this,b,c),d.path.push(c.position);
this.Polygon?this.Polygon.setOptions(d):this.Polygon=new f.maps.Polygon(d);f.maps.event.addListener(this.Polygon,"click",function(b){a.o.onPolygonClick(b)});this.add_polyEv("Polygon")},fusion:function(){this.o.fusion_options.styles=[this.o.stroke_options];this.o.fusion_options.map=this.oMap;this.Fusion?this.Fusion.setOptions(this.o.fusion_options):this.Fusion=new f.maps.FusionTablesLayer(this.o.fusion_options)},directions:function(){var a=this,b,c,d,e,r,k=[],h=0;for(b=0;b<this.ln;b++)c=this.create_objPoint(b),
0===b?e=c.position:b===this.ln-1?r=c.position:(d=!0===this.o.locations[b].stopover?!0:!1,k.push({location:c.position,stopover:d})),this.create.marker.call(this,b,c);this.o.directions_options.origin=e;this.o.directions_options.destination=r;this.o.directions_options.waypoints=k;this.directionsService||(this.directionsService=new f.maps.DirectionsService);this.directionsDisplay?this.directionsDisplay.setOptions({draggable:this.o.draggable}):this.directionsDisplay=new f.maps.DirectionsRenderer({draggable:this.o.draggable});
this.directionsDisplay.setMap(this.oMap);this.o.directions_panel&&(this.o.directions_panel=g(this.o.directions_panel),this.directionsDisplay.setPanel(this.o.directions_panel.get(0)));this.o.draggable&&f.maps.event.addListener(this.directionsDisplay,"directions_changed",function(){h=a.compute_distance(a.directionsDisplay.directions);a.o.afterRoute(h)});this.directionsService.route(this.o.directions_options,function(b,c){c===f.maps.DirectionsStatus.OK&&(h=a.compute_distance(b),a.directionsDisplay.setDirections(b));
a.o.afterRoute(h,c,b)})}};e.prototype.compute_distance=function(a){var b=0,c=a.routes[0],d=c.legs.length;for(a=0;a<d;a++)b+=c.legs[a].distance.value;return b};e.prototype.type_to_open={bubble:function(a){this.infowindow=new f.maps.InfoWindow({content:a.html||""})}};e.prototype.open_infowindow=function(a,b,c){this.CloseInfoWindow();c=this.o.locations[a];var d=this.o.infowindow_type;c.html&&this.type_to_open[d]&&(this.o.beforeOpenInfowindow(a,c,b),this.type_to_open[d].call(this,c),this.infowindow.open(this.oMap,
b),this.o.afterOpenInfowindow(a,c,b))};e.prototype.get_html_controls=function(){return this.controls[this.o.controls_type]&&this.controls[this.o.controls_type].getHtml?(this.current_control=this.controls[this.o.controls_type],this.current_control.getHtml.apply(this)):""};e.prototype.generate_controls=function(){if(this.o.controls_on_map){var a=g('<div class="on_gmap '+this.o.controls_type+' gmap_controls"></div>').css(this.o.controls_applycss?{margin:"5px"}:{}),b=g(this.get_html_controls()).css(this.o.controls_applycss?
{background:"#fff",padding:"5px",border:"1px solid rgb(113,123,135)",boxShadow:"rgba(0, 0, 0, 0.4) 0px 2px 4px",maxHeight:this.map_div.find(".canvas_map").outerHeight()-80,minWidth:100,overflowY:"auto",overflowX:"hidden"}:{});a.append(b);this.oMap.controls[this.o.controls_position].push(a.get(0))}else this.controls_wrapper.empty(),this.controls_wrapper.append(this.get_html_controls())};e.prototype.init_map=function(){var a=this;this.Polyline&&this.Polyline.setMap(null);this.Polygon&&this.Polygon.setMap(null);
this.Fusion&&this.Fusion.setMap(null);this.directionsDisplay&&this.directionsDisplay.setMap(null);for(var b=this.markers.length-1;0<=b;--b)try{this.markers[b]&&this.markers[b].setMap(null)}catch(c){a.debug("init_map::markers::setMap",c.stack)}this.markers.length=0;this.markers=[];for(b=this.circles.length-1;0<=b;--b)try{this.circles[b]&&this.circles[b].setMap(null)}catch(d){a.debug("init_map::circles::setMap",d.stack)}this.circles.length=0;this.circles=[];this.o.controls_on_map&&this.oMap.controls&&
this.oMap.controls[this.o.controls_position].forEach(function(b,c){try{a.oMap.controls[this.o.controls_position].removeAt(c)}catch(d){a.debug("init_map::removeAt",d.stack)}});this.oBounds=new f.maps.LatLngBounds};e.prototype.perform_load=function(){1===this.ln?(this.o.map_options.set_center?this.oMap.setCenter(new f.maps.LatLng(this.o.map_options.set_center[0],this.o.map_options.set_center[1])):(this.oMap.fitBounds(this.oBounds),this.ViewOnMap(1)),this.o.map_options.zoom&&this.oMap.setZoom(this.o.map_options.zoom)):
0===this.ln?(this.o.map_options.set_center?this.oMap.setCenter(new f.maps.LatLng(this.o.map_options.set_center[0],this.o.map_options.set_center[1])):this.oMap.fitBounds(this.oBounds),this.oMap.setZoom(this.o.map_options.zoom||1)):(this.oMap.fitBounds(this.oBounds),"number"===typeof(this.o.start-0)&&0<this.o.start&&this.o.start<=this.ln?this.ViewOnMap(this.o.start):this.o.map_options.set_center?this.oMap.setCenter(new f.maps.LatLng(this.o.map_options.set_center[0],this.o.map_options.set_center[1])):
this.ViewOnMap(this.view_all_key),this.o.map_options.zoom&&this.oMap.setZoom(this.o.map_options.zoom))};e.prototype.debug=function(a,b){this.o.debug&&console.log(a,b);return this};e.prototype.AddControl=function(a,b){if(!a||!b)return self.debug("AddControl",'Missing "name" and "func" callback.'),!1;this.controls[a]=b;return this};e.prototype.CloseInfoWindow=function(){this.infowindow&&(this.current_index||0===this.current_index)&&(this.o.beforeCloseInfowindow(this.current_index,this.o.locations[this.current_index]),
this.infowindow.close(),this.infowindow=null,this.o.afterCloseInfowindow(this.current_index,this.o.locations[this.current_index]));return this};e.prototype.ShowOnMenu=function(a){if(a===this.view_all_key&&this.o.view_all&&1<this.ln)return!0;a=parseInt(a,10);return"number"===typeof(a-0)&&0<=a&&a<this.ln&&!1!==this.o.locations[a].on_menu?!0:!1};e.prototype.ViewOnMap=function(a){if(a===this.view_all_key)this.o.beforeViewAll(),this.current_index=a,0<this.o.locations.length&&this.o.generate_controls&&
this.current_control&&this.current_control.activateCurrent&&this.current_control.activateCurrent.apply(this,[a]),this.oMap.fitBounds(this.oBounds),this.CloseInfoWindow(),this.o.afterViewAll();else if(a=parseInt(a,10),"number"===typeof(a-0)&&0<a&&a<=this.ln)try{f.maps.event.trigger(this.markers[a-1],"click")}catch(b){this.debug("ViewOnMap::trigger",b.stack)}return this};e.prototype.SetLocations=function(a,b){this.o.locations=a;b&&this.Load();return this};e.prototype.AddLocations=function(a,b){var c=
this;g.isArray(a)&&g.each(a,function(a,b){c.o.locations.push(b)});g.isPlainObject(a)&&this.o.locations.push(a);b&&this.Load();return this};e.prototype.AddLocation=function(a,b,c){g.isPlainObject(a)&&this.o.locations.splice(b,0,a);c&&this.Load();return this};e.prototype.RemoveLocations=function(a,b){var c=this,d=0;g.isArray(a)?g.each(a,function(a,b){b-d<c.ln&&c.o.locations.splice(b-d,1);d++}):a<this.ln&&this.o.locations.splice(a,1);b&&this.Load();return this};e.prototype.Loaded=function(){return this.loaded};
e.prototype._init=function(){this.ln=this.o.locations.length;for(var a=0;a<this.ln;a++){var b=g.extend({},this.o.shared);this.o.locations[a]=g.extend(b,this.o.locations[a]);this.o.locations[a].html&&(this.o.locations[a].html=this.o.locations[a].html.replace("%index",a+1),this.o.locations[a].html=this.o.locations[a].html.replace("%title",this.o.locations[a].title||""))}this.map_div=g(this.o.map_div);this.controls_wrapper=g(this.o.controls_div);return this};e.prototype.Load=function(a){g.extend(!0,
this.o,a);a&&a.locations&&(this.o.locations=a.locations);this._init();!1===this.o.visualRefresh?f.maps.visualRefresh=!1:f.maps.visualRefresh=!0;this.init_map();this.create_objMap();this.add_markers_to_objMap();1<this.ln&&this.o.generate_controls||this.o.force_generate_controls?(this.o.generate_controls=!0,this.generate_controls()):this.o.generate_controls=!1;var b=this;if(this.loaded)this.perform_load();else{f.maps.event.addListenerOnce(this.oMap,"idle",function(){b.perform_load()});f.maps.event.addListener(this.oMap,
"resize",function(){b.canvas_map.css({width:b.map_div.width(),height:b.map_div.height()})});for(var c in this.o.listeners){var d=this.oMap,e=this.o.listeners[c];this.o.listeners.hasOwnProperty(c)&&f.maps.event.addListener(this.oMap,c,function(a){e(d,a)})}}this.loaded=!0;return this};return e}();"function"==typeof define&&define.amd?define(function(){return p}):t.Maplace=p})(jQuery,this,google);


/**
 * jQuery Geocoding and Places Autocomplete Plugin - V 1.6.5
 *
 * @author Martin Kleppe <kleppe@ubilabs.net>, 2014
 * @author Ubilabs http://ubilabs.net, 2014
 * @license MIT License <http://www.opensource.org/licenses/mit-license.php>
 */
(function($,window,document,undefined){var defaults={bounds:true,country:null,map:false,details:false,detailsAttribute:"name",autoselect:true,location:false,mapOptions:{zoom:14,scrollwheel:false,mapTypeId:"roadmap"},markerOptions:{draggable:false},maxZoom:16,types:["geocode"],blur:false,geocodeAfterResult:false,restoreValueAfterBlur:false};var componentTypes=("street_address route intersection political "+"country administrative_area_level_1 administrative_area_level_2 "+"administrative_area_level_3 colloquial_area locality sublocality "+"neighborhood premise subpremise postal_code natural_feature airport "+"park point_of_interest post_box street_number floor room "+"lat lng viewport location "+"formatted_address location_type bounds").split(" ");var placesDetails=("id place_id url website vicinity reference name rating "+"international_phone_number icon formatted_phone_number").split(" ");function GeoComplete(input,options){this.options=$.extend(true,{},defaults,options);this.input=input;this.$input=$(input);this._defaults=defaults;this._name="geocomplete";this.init()}$.extend(GeoComplete.prototype,{init:function(){this.initMap();this.initMarker();this.initGeocoder();this.initDetails();this.initLocation()},initMap:function(){if(!this.options.map){return}if(typeof this.options.map.setCenter=="function"){this.map=this.options.map;return}this.map=new google.maps.Map($(this.options.map)[0],this.options.mapOptions);google.maps.event.addListener(this.map,"click",$.proxy(this.mapClicked,this));google.maps.event.addListener(this.map,"zoom_changed",$.proxy(this.mapZoomed,this))},initMarker:function(){if(!this.map){return}var options=$.extend(this.options.markerOptions,{map:this.map});if(options.disabled){return}this.marker=new google.maps.Marker(options);google.maps.event.addListener(this.marker,"dragend",$.proxy(this.markerDragged,this))},initGeocoder:function(){var selected=false;var options={types:this.options.types,bounds:this.options.bounds===true?null:this.options.bounds,componentRestrictions:this.options.componentRestrictions};if(this.options.country){options.componentRestrictions={country:this.options.country}}this.autocomplete=new google.maps.places.Autocomplete(this.input,options);this.geocoder=new google.maps.Geocoder;if(this.map&&this.options.bounds===true){this.autocomplete.bindTo("bounds",this.map)}google.maps.event.addListener(this.autocomplete,"place_changed",$.proxy(this.placeChanged,this));this.$input.on("keypress."+this._name,function(event){if(event.keyCode===13){return false}});if(this.options.geocodeAfterResult===true){this.$input.bind("keypress."+this._name,$.proxy(function(){if(event.keyCode!=9&&this.selected===true){this.selected=false}},this))}this.$input.bind("geocode."+this._name,$.proxy(function(){this.find()},this));this.$input.bind("geocode:result."+this._name,$.proxy(function(){this.lastInputVal=this.$input.val()},this));if(this.options.blur===true){this.$input.on("blur."+this._name,$.proxy(function(){if(this.options.geocodeAfterResult===true&&this.selected===true){return}if(this.options.restoreValueAfterBlur===true&&this.selected===true){setTimeout($.proxy(this.restoreLastValue,this),0)}else{this.find()}},this))}},initDetails:function(){if(!this.options.details){return}var $details=$(this.options.details),attribute=this.options.detailsAttribute,details={};function setDetail(value){details[value]=$details.find("["+attribute+"="+value+"]")}$.each(componentTypes,function(index,key){setDetail(key);setDetail(key+"_short")});$.each(placesDetails,function(index,key){setDetail(key)});this.$details=$details;this.details=details},initLocation:function(){var location=this.options.location,latLng;if(!location){return}if(typeof location=="string"){this.find(location);return}if(location instanceof Array){latLng=new google.maps.LatLng(location[0],location[1])}if(location instanceof google.maps.LatLng){latLng=location}if(latLng){if(this.map){this.map.setCenter(latLng)}if(this.marker){this.marker.setPosition(latLng)}}},destroy:function(){if(this.map){google.maps.event.clearInstanceListeners(this.map);google.maps.event.clearInstanceListeners(this.marker)}this.autocomplete.unbindAll();google.maps.event.clearInstanceListeners(this.autocomplete);google.maps.event.clearInstanceListeners(this.input);this.$input.removeData();this.$input.off(this._name);this.$input.unbind("."+this._name)},find:function(address){this.geocode({address:address||this.$input.val()})},geocode:function(request){if(this.options.bounds&&!request.bounds){if(this.options.bounds===true){request.bounds=this.map&&this.map.getBounds()}else{request.bounds=this.options.bounds}}if(this.options.country){request.region=this.options.country}this.geocoder.geocode(request,$.proxy(this.handleGeocode,this))},selectFirstResult:function(){var selected="";if($(".pac-item-selected")[0]){selected="-selected"}var $span1=$(".pac-container:last .pac-item"+selected+":first span:nth-child(2)").text();var $span2=$(".pac-container:last .pac-item"+selected+":first span:nth-child(3)").text();var firstResult=$span1;if($span2){firstResult+=" - "+$span2}this.$input.val(firstResult);return firstResult},restoreLastValue:function(){if(this.lastInputVal){this.$input.val(this.lastInputVal)}},handleGeocode:function(results,status){if(status===google.maps.GeocoderStatus.OK){var result=results[0];this.$input.val(result.formatted_address);this.update(result);if(results.length>1){this.trigger("geocode:multiple",results)}}else{this.trigger("geocode:error",status)}},trigger:function(event,argument){this.$input.trigger(event,[argument])},center:function(geometry){if(geometry.viewport){this.map.fitBounds(geometry.viewport);if(this.map.getZoom()>this.options.maxZoom){this.map.setZoom(this.options.maxZoom)}}else{this.map.setZoom(this.options.maxZoom);this.map.setCenter(geometry.location)}if(this.marker){this.marker.setPosition(geometry.location);this.marker.setAnimation(this.options.markerOptions.animation)}},update:function(result){if(this.map){this.center(result.geometry)}if(this.$details){this.fillDetails(result)}this.trigger("geocode:result",result)},fillDetails:function(result){var data={},geometry=result.geometry,viewport=geometry.viewport,bounds=geometry.bounds;$.each(result.address_components,function(index,object){var name=object.types[0];$.each(object.types,function(index,name){data[name]=object.long_name;data[name+"_short"]=object.short_name})});$.each(placesDetails,function(index,key){data[key]=result[key]});$.extend(data,{formatted_address:result.formatted_address,location_type:geometry.location_type||"PLACES",viewport:viewport,bounds:bounds,location:geometry.location,lat:geometry.location.lat(),lng:geometry.location.lng()});$.each(this.details,$.proxy(function(key,$detail){var value=data[key];this.setDetail($detail,value)},this));this.data=data},setDetail:function($element,value){if(value===undefined){value=""}else if(typeof value.toUrlValue=="function"){value=value.toUrlValue()}if($element.is(":input")){$element.val(value)}else{$element.text(value)}},markerDragged:function(event){this.trigger("geocode:dragged",event.latLng)},mapClicked:function(event){this.trigger("geocode:click",event.latLng)},mapZoomed:function(event){this.trigger("geocode:zoom",this.map.getZoom())},resetMarker:function(){this.marker.setPosition(this.data.location);this.setDetail(this.details.lat,this.data.location.lat());this.setDetail(this.details.lng,this.data.location.lng())},placeChanged:function(){var place=this.autocomplete.getPlace();this.selected=true;if(!place.geometry){if(this.options.autoselect){var autoSelection=this.selectFirstResult();this.find(autoSelection)}}else{this.update(pla