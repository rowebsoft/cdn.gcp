$(function(){if($('#search-custom-fields').length){if($('select[id=category_search] option:selected').attr('data-id')){$.ajax({url:$('#search-custom-fields').data('apiurl')+'/'+ $('select[id=category_search] option:selected').data('id'),success:function(results){$('#search-custom-fields').css('display','inline-block');createSearchCustomFieldsByCategory(results.category.customfields);}});}
else{$.ajax({url:$('#search-custom-fields').data('apiurl')+'/'+ 1,success:function(results){createSearchCustomFieldsByCategory(results.category.customfields);}});}}
if($('#widget-custom-fields').length){if($('select[id=category_widget_search] option:selected').attr('data-id')){$.ajax({url:$('#widget-custom-fields').data('apiurl')+'/'+ $('select[id=category_widget_search] option:selected').data('id'),success:function(results){createWidgetCustomFieldsByCategory(results.category.customfields);}});}
else{$.ajax({url:$('#widget-custom-fields').data('apiurl')+'/'+ 1,success:function(results){createWidgetCustomFieldsByCategory(results.category.customfields);}});}}});$('select[id=category_search]').change(function(){if($('select[id=category_search] option:selected').attr('data-id')){$.ajax({url:$('#search-custom-fields').data('apiurl')+'/'+ $('select[id=category_search] option:selected').data('id'),success:function(results){$('#search-custom-fields').css('display','inline-block');createSearchCustomFieldsByCategory(results.category.customfields);}});}
else{$.ajax({url:$('#search-custom-fields').data('apiurl')+'/'+ 1,success:function(results){createSearchCustomFieldsByCategory(results.category.customfields);}});}});$("select[id=category_widget_search]").change(function(){if($('select[id=category_widget_search] option:selected').attr('data-id')){$.ajax({url:$('#widget-custom-fields').data('apiurl')+'/'+ $('select[id=category_widget_search] option:selected').data('id'),success:function(results){createWidgetCustomFieldsByCategory(results.category.customfields);}});}
else{$.ajax({url:$('#widget-custom-fields').data('apiurl')+'/'+ 1,success:function(results){createWidgetCustomFieldsByCategory(results.category.customfields);}});}});function createSearchCustomFieldsByCategory(customfields){$('#search-custom-fields > div').not("#search-custom-field-template").remove();$.each(customfields,function(idx,customfield){if(customfield.searchable===false)
return;var $template=$('#search-custom-field-template').clone().attr('id','').removeClass('hidden').appendTo('#search-custom-fields').after(' ');$template.find('div[data-label]').replaceWith($('<label/>').attr({'for':idx}).html(customfield.label));switch(customfield.type){case'string':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#search-custom-fields').data('customfield-values')[idx],}));break;case'textarea':$template.find('div[data-input]').replaceWith($('<textarea/>').attr({'id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'rows':10,'cols':50,'data-type':customfield.type,}).append($('#search-custom-fields').data('customfield-values')[idx]));break;case'integer':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#search-custom-fields').data('customfield-values')[idx],}));break;case'decimal':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#search-custom-fields').data('customfield-values')[idx],}));break;case'range':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx+'-min','name':idx+'[]','class':'form-control','placeholder':getCFSearchLocalization('from'),'data-type':customfield.type,'value':($('#search-custom-fields').data('customfield-values')[idx]&&0 in $('#search-custom-fields').data('customfield-values')[idx])?$('#search-custom-fields').data('customfield-values')[idx][0]:'',}));$('<input/>').attr({'type':'text','id':idx+'-max','name':idx+'[]','class':'form-control','placeholder':getCFSearchLocalization('to'),'data-type':customfield.type,'value':($('#search-custom-fields').data('customfield-values')[idx]&&1 in $('#search-custom-fields').data('customfield-values')[idx])?$('#search-custom-fields').data('customfield-values')[idx][1]:'',}).insertAfter('#search-custom-fields input[id="'+ idx+'-min'+'"]');$('#search-custom-fields input[id="'+ idx+'-min'+'"]').parent('div').find('input').wrapAll("<div class='row'></div>");$('#search-custom-fields input[id="'+ idx+'-min'+'"]').wrap("<div class='col-sm-6'></div>");$('#search-custom-fields input[id="'+ idx+'-max'+'"]').wrap("<div class='col-sm-6'></div>");break;case'date':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'data-date-format':'yyyy-mm-dd','value':$('#search-custom-fields').data('customfield-values')[idx],}));$('#search-custom-fields input[name="'+ idx+'"]').datepicker({autoclose:true})
break;case'email':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'email','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#search-custom-fields').data('customfield-values')[idx],}));break;case'select':$template.find('div[data-input]').replaceWith($('<select/>').attr({'id':idx,'name':idx+'[]','multiple':true,'class':'form-control','placeholder':customfield.label,'data-placeholder':customfield.label,'data-type':customfield.type,}));for(var val in customfield.values){$('#search-custom-fields select[name="'+ idx+'[]"]').append($('<option/>').val(customfield.values[val]).html(customfield.values[val]));}
$('#search-custom-fields select[name="'+ idx+'[]"]').val($('#search-custom-fields').data('customfield-values')[idx]);$('#search-custom-fields select[name="'+ idx+'[]"]').select2({"language":"es"});break;case'country':$template.find('div[data-input]').replaceWith($('<select/>').attr({'id':idx,'name':idx+'[]','multiple':true,'class':'form-control','placeholder':customfield.label,'data-placeholder':customfield.label,'data-type':customfield.type,}));for(var val in customfield.values){$('#search-custom-fields select[name="'+ idx+'[]"]').append($('<option/>').val(val).html(customfield.values[val]));}
$('#search-custom-fields select[name="'+ idx+'[]"]').val($('#search-custom-fields').data('customfield-values')[idx]);$('#search-custom-fields select[name="'+ idx+'[]"]').select2({"language":"es"});break;case'radio':$.each(customfield.values,function(radioidx,value){$('<div/>').attr('class','radio').append($('<label/>').append($('<input/>').attr({'type':'radio','id':idx,'name':idx,'data-type':customfield.type,'value':radioidx+ 1,'checked':((radioidx+ 1)==$('#search-custom-fields').data('customfield-values')[idx])?true:false,})).append(value)).insertBefore($template.find('div[data-input]'));});$template.find('div[data-input]').remove();break;case'checkbox':$template.find('div[data-input]').wrap('<div class="checkbox"></div>').wrap('<label></label>');$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'checkbox','id':idx,'name':idx,'data-type':customfield.type,'checked':$('#search-custom-fields').data('customfield-values')[idx],}));break;}})}
function createWidgetCustomFieldsByCategory(customfields){$('#widget-custom-fields > div').not("#widget-custom-field-template").remove();$.each(customfields,function(idx,customfield){if(customfield.searchable===false)
return;var $template=$('#widget-custom-field-template').clone().attr('id','').removeClass('hidden').appendTo('#widget-custom-fields').after(' ');$template.find('div[data-label]').replaceWith($('<label/>').attr({'for':idx}).html(customfield.label));switch(customfield.type){case'string':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#widget-custom-fields').data('customfield-values')[idx],}));break;case'textarea':$template.find('div[data-input]').replaceWith($('<textarea/>').attr({'id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'rows':10,'cols':50,'data-type':customfield.type,}).append($('#widget-custom-fields').data('customfield-values')[idx]));break;case'integer':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#widget-custom-fields').data('customfield-values')[idx],}));break;case'decimal':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#widget-custom-fields').data('customfield-values')[idx],}));break;case'range':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx+'-min','name':idx+'[]','class':'form-control','placeholder':getCFSearchLocalization('from'),'data-type':customfield.type,'value':($('#widget-custom-fields').data('customfield-values')[idx]&&0 in $('#widget-custom-fields').data('customfield-values')[idx])?$('#widget-custom-fields').data('customfield-values')[idx][0]:'',}));$('<input/>').attr({'type':'text','id':idx+'-max','name':idx+'[]','class':'form-control','placeholder':getCFSearchLocalization('to'),'data-type':customfield.type,'value':($('#widget-custom-fields').data('customfield-values')[idx]&&1 in $('#widget-custom-fields').data('customfield-values')[idx])?$('#widget-custom-fields').data('customfield-values')[idx][1]:'',}).insertAfter('#widget-custom-fields input[id="'+ idx+'-min'+'"]');$("<span> - </span>").insertAfter('#widget-custom-fields input[id="'+ idx+'-min'+'"]');break;case'date':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'text','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'data-date-format':'yyyy-mm-dd','value':$('#widget-custom-fields').data('customfield-values')[idx],}));$('#widget-custom-fields input[name="'+ idx+'"]').datepicker()
break;case'email':$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'email','id':idx,'name':idx,'class':'form-control','placeholder':customfield.label,'data-type':customfield.type,'value':$('#widget-custom-fields').data('customfield-values')[idx],}));break;case'select':$template.find('div[data-input]').replaceWith($('<select/>').attr({'id':idx,'name':idx+'[]','multiple':true,'class':'form-control','placeholder':customfield.label,'data-placeholder':customfield.label,'data-type':customfield.type,}));for(var val in customfield.values){$('#widget-custom-fields select[name="'+ idx+'[]"]').append($('<option/>').val(customfield.values[val]).html(customfield.values[val]));}
$('#widget-custom-fields select[name="'+ idx+'[]"]').val($('#widget-custom-fields').data('customfield-values')[idx]);$('#widget-custom-fields select[name="'+ idx+'[]"]').select2({"language":"es"});break;case'radio':$.each(customfield.values,function(radioidx,value){$('<div/>').attr('class','radio').append($('<label/>').append($('<input/>').attr({'type':'radio','id':idx,'name':idx,'data-type':customfield.type,'value':radioidx+ 1,'checked':((radioidx+ 1)==$('#widget-custom-fields').data('customfield-values')[idx])?true:false,})).append(value)).insertBefore($template.find('div[data-input]'));});$template.find('div[data-input]').remove();break;case'checkbox':$template.find('div[data-input]').wrap('<div class="checkbox"></div>').wrap('<label></label>');$template.find('div[data-input]').replaceWith($('<input/>').attr({'type':'checkbox','id':idx,'name':idx,'data-type':customfield.type,'checked':$('#widget-custom-fields').data('customfield-values')[idx],}));break;}})}